warning: hard linking files in the incremental compilation cache failed. copying files instead. consider moving the cache directory to a file system which supports hard linking in session dir `/vagrant/rusty_c/mydisk/target/debug/incremental/build_script_build-2tu1pdiw831j2/s-gmw5fu1sad-u9wyo7-working`

warning: unused import: `std::process::Command`
 --> build.rs:3:5
  |
3 | use std::process::Command;
  |     ^^^^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` on by default

warning: `mydisk` (build script) generated 2 warnings
warning: /vagrant/rusty_c/mydisk/file/disk.h:1:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/egos.h:1:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/file.h:33:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/inode.h:38:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/disk.c: In function 'disk_setsize':
warning: /vagrant/rusty_c/mydisk/file/disk.c:16:1: warning: no return statement in function returning non-void [-Wreturn-type]
warning:  static int disk_setsize() { FATAL("disk: cannot set the size"); }
warning:  ^~~~~~
warning: /vagrant/rusty_c/mydisk/file/disk.c: In function 'disk_read':
warning: /vagrant/rusty_c/mydisk/file/disk.c:18:33: warning: unused parameter 'bs' [-Wunused-parameter]
warning:  static int disk_read(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                       ~~~~~~~~~~~^~
warning: /vagrant/rusty_c/mydisk/file/disk.c:18:50: warning: unused parameter 'ino' [-Wunused-parameter]
warning:  static int disk_read(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                                      ~~~~~~~~~~~~~^~~
warning: /vagrant/rusty_c/mydisk/file/disk.c: In function 'disk_write':
warning: /vagrant/rusty_c/mydisk/file/disk.c:22:34: warning: unused parameter 'bs' [-Wunused-parameter]
warning:  static int disk_write(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                        ~~~~~~~~~~~^~
warning: /vagrant/rusty_c/mydisk/file/disk.c:22:51: warning: unused parameter 'ino' [-Wunused-parameter]
warning:  static int disk_write(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                                       ~~~~~~~~~~~~~^~~
   Compiling mydisk v0.1.0 (/vagrant/rusty_c/mydisk)
error[E0434]: can't capture dynamic environment in a fn item
  --> src/lib.rs:42:13
   |
42 |             self.ds_get_size()
   |             ^^^^
   |
   = help: use the `|| { ... }` closure form instead

error[E0434]: can't capture dynamic environment in a fn item
  --> src/lib.rs:50:13
   |
50 |             self.ds_set_size()
   |             ^^^^
   |
   = help: use the `|| { ... }` closure form instead

error[E0434]: can't capture dynamic environment in a fn item
  --> src/lib.rs:70:15
   |
70 |             (*inode_store).getsize.unwrap()()
   |               ^^^^^^^^^^^
   |
   = help: use the `|| { ... }` closure form instead

error[E0434]: can't capture dynamic environment in a fn item
  --> src/lib.rs:74:15
   |
74 |             (*inode_store).setsize.unwrap()()
   |               ^^^^^^^^^^^
   |
   = help: use the `|| { ... }` closure form instead

error[E0435]: attempt to use a non-constant value in a constant
   --> src/lib.rs:186:27
    |
184 |         let row_width_in_bytes = libm::ceil(blocks_per_inode as f64 / 8 as f64) as u32;
    |         ---------------------- help: consider using `const` instead of `let`: `const row_width_in_bytes`
185 |         // assume rows <= 512 bytes (BLOCK_SIZE)
186 |         if size_of::<[u8; row_width_in_bytes]>() > BLOCK_SIZE {
    |                           ^^^^^^^^^^^^^^^^^^ non-constant value

error[E0435]: attempt to use a non-constant value in a constant
   --> src/lib.rs:190:29
    |
184 |         let row_width_in_bytes = libm::ceil(blocks_per_inode as f64 / 8 as f64) as u32;
    |         ---------------------- help: consider using `const` instead of `let`: `const row_width_in_bytes`
...
190 |             (size_of::<[u8; row_width_in_bytes]>() * self.num_inodes) as f64 / 
    |                             ^^^^^^^^^^^^^^^^^^ non-constant value

error[E0433]: failed to resolve: use of undeclared type `Box`
  --> src/common.rs:56:21
   |
56 |     let mut block = Box::new(block_t {
   |                     ^^^ use of undeclared type `Box`
   |
help: consider importing one of these items
   |
5  + use alloc::boxed::Box;
   |
5  + use crate::Box;
   |

error[E0433]: failed to resolve: use of undeclared type `Box`
  --> src/common.rs:60:5
   |
60 |     Box::into_raw(block)
   |     ^^^ use of undeclared type `Box`
   |
help: consider importing one of these items
   |
5  + use alloc::boxed::Box;
   |
5  + use crate::Box;
   |

warning: type `block_no` should have an upper camel case name
  --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:27:10
   |
27 | pub type block_no = cty::c_uint;
   |          ^^^^^^^^ help: convert the identifier to upper camel case: `BlockNo`
   |
   = note: `#[warn(non_camel_case_types)]` on by default

warning: type `block_t` should have an upper camel case name
  --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:58:10
   |
58 | pub type block_t = block;
   |          ^^^^^^^ help: convert the identifier to upper camel case: `BlockT`

warning: type `inode_store_t` should have an upper camel case name
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:155:10
    |
155 | pub type inode_store_t = inode_store;
    |          ^^^^^^^^^^^^^ help: convert the identifier to upper camel case: `InodeStoreT`

warning: type `inode_intf` should have an upper camel case name
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:156:10
    |
156 | pub type inode_intf = *mut inode_store_t;
    |          ^^^^^^^^^^ help: convert the identifier to upper camel case: `InodeIntf`

warning: type `earth__bindgen_ty_1` should have an upper camel case name
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:488:10
    |
488 | pub type earth__bindgen_ty_1 = cty::c_uint;
    |          ^^^^^^^^^^^^^^^^^^^ help: convert the identifier to upper camel case: `EarthBindgenTy1`

warning: type `earth__bindgen_ty_2` should have an upper camel case name
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:491:10
    |
491 | pub type earth__bindgen_ty_2 = cty::c_uint;
    |          ^^^^^^^^^^^^^^^^^^^ help: convert the identifier to upper camel case: `EarthBindgenTy2`

warning: crate-level attribute should be in the root module
 --> src/common.rs:1:1
  |
1 | #![feature(alloc)]
  | ^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_attributes)]` on by default

error[E0425]: cannot find function `malloc` in this scope
  --> src/common.rs:22:9
   |
22 |         malloc(layout.size() as cty::size_t) as *mut u8
   |         ^^^^^^ not found in this scope

error[E0425]: cannot find function `free` in this scope
  --> src/common.rs:26:9
   |
26 |         free(ptr as *mut cty::c_void);
   |         ^^^^ not found in this scope

error[E0277]: the trait bound `*mut inode_store: From<&DiskFS>` is not satisfied
   --> src/lib.rs:103:35
    |
103 |         match (self.ds_read)(self.into(), ino, offset, buf.into()) {
    |                                   ^^^^ the trait `From<&DiskFS>` is not implemented for `*mut inode_store`
    |
    = note: required for `&DiskFS` to implement `Into<*mut inode_store>`

error[E0277]: the trait bound `*mut block: From<&mut common::Block>` is not satisfied
   --> src/lib.rs:103:60
    |
103 |         match (self.ds_read)(self.into(), ino, offset, buf.into()) {
    |                                                            ^^^^ the trait `From<&mut common::Block>` is not implemented for `*mut block`
    |
    = note: required for `&mut common::Block` to implement `Into<*mut block>`

error[E0277]: the trait bound `*mut inode_store: From<&mut DiskFS>` is not satisfied
   --> src/lib.rs:110:36
    |
110 |         match (self.ds_write)(self.into(), ino, offset, buf.into()) {
    |                                    ^^^^ the trait `From<&mut DiskFS>` is not implemented for `*mut inode_store`
    |
    = note: required for `&mut DiskFS` to implement `Into<*mut inode_store>`

error[E0277]: the trait bound `*mut block: From<&common::Block>` is not satisfied
   --> src/lib.rs:110:61
    |
110 |         match (self.ds_write)(self.into(), ino, offset, buf.into()) {
    |                                                             ^^^^ the trait `From<&common::Block>` is not implemented for `*mut block`
    |
    = note: required for `&common::Block` to implement `Into<*mut block>`

error[E0308]: mismatched types
   --> src/lib.rs:160:23
    |
136 | impl<T: Stackable + IsDisk> SimpleFS<'_, T> {
    |      - this type parameter
...
160 |         SimpleFS::new(&mut below, below_ino, num_inodes)
    |         ------------- ^^^^^^^^^^ expected `&mut T`, found `&mut DiskFS`
    |         |
    |         arguments to this function are incorrect
    |
    = note: expected mutable reference `&mut T`
               found mutable reference `&mut DiskFS`
note: associated function defined here
   --> src/lib.rs:137:12
    |
137 |     pub fn new(below: &mut T, below_ino: u32, num_inodes: u32) -> Self {
    |            ^^^ -------------

error[E0277]: the trait bound `*mut inode_store: From<&mut T>` is not satisfied
   --> src/lib.rs:166:31
    |
166 |             below: self.below.into(),
    |                               ^^^^ the trait `From<&mut T>` is not implemented for `*mut inode_store`
    |
    = help: the trait `Into<U>` is implemented for `T`
    = note: required for `&mut T` to implement `Into<*mut inode_store>`

error[E0308]: mismatched types
   --> src/lib.rs:172:34
    |
172 |             state: Box::into_raw(cur_state),
    |                    ------------- ^^^^^^^^^ expected `Box<c_void, _>`, found `Box<SimpleFS_C>`
    |                    |
    |                    arguments to this function are incorrect
    |
    = note: expected struct `Box<c_void, _>`
               found struct `Box<SimpleFS_C, alloc::alloc::Global>`
note: associated function defined here
   --> /rustc/90c541806f23a127002de5b4038be731ba1458ca/library/alloc/src/boxed.rs:1042:12

error[E0308]: mismatched types
   --> src/lib.rs:173:22
    |
173 |             getsize: simfs_get_size,
    |                      ^^^^^^^^^^^^^^ expected `Option<unsafe extern "C" fn(..., ...) -> ...>`, found fn item
    |
    = note: expected enum `Option<unsafe extern "C" fn(*mut inode_store, u32) -> i32>`
            found fn item `unsafe extern "C" fn(*mut inode_store, u32) -> u32 {simfs_get_size}`

error[E0308]: mismatched types
   --> src/lib.rs:174:22
    |
174 |             setsize: simfs_set_size,
    |                      ^^^^^^^^^^^^^^ expected `Option<unsafe extern "C" fn(..., ..., ...) -> ...>`, found fn item
    |
    = note: expected enum `Option<unsafe extern "C" fn(*mut inode_store, u32, u32) -> i32>`
            found fn item `unsafe extern "C" fn(*mut inode_store, i32) -> i32 {simfs_set_size}`

error[E0308]: mismatched types
   --> src/lib.rs:175:19
    |
175 |             read: simfs_read,
    |                   ^^^^^^^^^^ expected `Option<unsafe extern "C" fn(..., ..., ..., ...) -> ...>`, found fn item
    |
    = note: expected enum `Option<unsafe extern "C" fn(*mut inode_store, u32, u32, *mut block) -> i32>`
            found fn item `unsafe extern "C" fn(*mut inode_store, u32, u32, *mut block) -> i32 {simfs_read}`
help: try wrapping the expression in `core::prelude::v1::Some`
    |
175 |             read: core::prelude::v1::Some(simfs_read),
    |                   ++++++++++++++++++++++++          +

error[E0308]: mismatched types
   --> src/lib.rs:176:20
    |
176 |             write: simfs_write
    |                    ^^^^^^^^^^^ expected `Option<unsafe extern "C" fn(..., ..., ..., ...) -> ...>`, found fn item
    |
    = note: expected enum `Option<unsafe extern "C" fn(*mut inode_store, u32, u32, *mut block) -> i32>`
            found fn item `unsafe extern "C" fn(*mut inode_store, u32, u32, *mut block) -> i32 {simfs_write}`
help: try wrapping the expression in `core::prelude::v1::Some`
    |
176 |             write: core::prelude::v1::Some(simfs_write)
    |                    ++++++++++++++++++++++++           +

error[E0308]: mismatched types
   --> src/lib.rs:186:52
    |
186 |         if size_of::<[u8; row_width_in_bytes]>() > BLOCK_SIZE {
    |            -------------------------------------   ^^^^^^^^^^ expected `usize`, found `u32`
    |            |
    |            expected because this is `usize`
    |
help: you can convert a `u32` to a `usize` and panic if the converted value doesn't fit
    |
186 |         if size_of::<[u8; row_width_in_bytes]>() > BLOCK_SIZE.try_into().unwrap() {
    |                                                              ++++++++++++++++++++

error[E0308]: mismatched types
   --> src/lib.rs:190:54
    |
190 |             (size_of::<[u8; row_width_in_bytes]>() * self.num_inodes) as f64 / 
    |                                                      ^^^^^^^^^^^^^^^ expected `usize`, found `u32`

error[E0277]: cannot multiply `usize` by `u32`
   --> src/lib.rs:190:52
    |
190 |             (size_of::<[u8; row_width_in_bytes]>() * self.num_inodes) as f64 / 
    |                                                    ^ no implementation for `usize * u32`
    |
    = help: the trait `Mul<u32>` is not implemented for `usize`
    = help: the following other types implement trait `Mul<Rhs>`:
              <&'a usize as Mul<usize>>
              <&usize as Mul<&usize>>
              <usize as Mul<&usize>>
              <usize as Mul>

error[E0308]: mismatched types
   --> src/lib.rs:193:9
    |
181 |       fn compute_metadata(&self) -> Result<Metadata, Error> {
    |                                     ----------------------- expected `Result<Metadata, common::Error>` because of return type
...
193 | /         Metadata {
194 | |             row_width: row_width_in_bytes,
195 | |             num_blocks_needed: num_blocks_needed
196 | |         }
    | |_________^ expected `Result<Metadata, Error>`, found `Metadata`
    |
    = note: expected enum `Result<Metadata, common::Error>`
             found struct `Metadata`
help: try wrapping the expression in `core::prelude::v1::Ok`
    |
193 ~         core::prelude::v1::Ok(Metadata {
194 |             row_width: row_width_in_bytes,
195 |             num_blocks_needed: num_blocks_needed
196 ~         })
    |

error[E0308]: mismatched types
   --> src/lib.rs:216:21
    |
216 |         for i in 0..num_blocks_needed {
    |                     ^^^^^^^^^^^^^^^^^ expected integer, found `&u32`
    |
help: consider dereferencing the borrow
    |
216 |         for i in 0..*num_blocks_needed {
    |                     +

error[E0308]: mismatched types
   --> src/lib.rs:220:37
    |
220 |         for i in num_blocks_needed..num_inodes {
    |                                     ^^^^^^^^^^
    |                                     |
    |                                     expected `&u32`, found `u32`
    |                                     help: consider borrowing here: `&num_inodes`

error[E0277]: the trait bound `&u32: Step` is not satisfied
   --> src/lib.rs:220:18
    |
220 |         for i in num_blocks_needed..num_inodes {
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ the trait `Step` is not implemented for `&u32`
    |
    = help: the trait `Step` is implemented for `u32`
    = note: required for `core::ops::Range<&u32>` to implement `Iterator`
    = note: required for `core::ops::Range<&u32>` to implement `IntoIterator`

error[E0308]: mismatched types
   --> src/lib.rs:222:29
    |
222 |             simple_fs.write(i, 0, &mut buf)?;
    |                       ----- ^ expected `u32`, found `&u32`
    |                       |
    |                       arguments to this method are incorrect
    |
note: method defined here
   --> src/common.rs:77:6
    |
77  |   fn write(&mut self, ino: u32, offset: u32, buf: &Block) -> 
    |      ^^^^^
help: consider dereferencing the borrow
    |
222 |             simple_fs.write(*i, 0, &mut buf)?;
    |                             +

error[E0308]: mismatched types
   --> src/lib.rs:236:13
    |
236 |         Ok((block_no, byte_index, bit_index))
    |             ^^^^^^^^ expected `i32`, found `u32`
    |
help: you can convert a `u32` to an `i32` and panic if the converted value doesn't fit
    |
236 |         Ok((block_no.try_into().unwrap(), byte_index, bit_index))
    |                     ++++++++++++++++++++

error[E0308]: mismatched types
   --> src/lib.rs:236:23
    |
236 |         Ok((block_no, byte_index, bit_index))
    |                       ^^^^^^^^^^ expected `i32`, found `u32`
    |
help: you can convert a `u32` to an `i32` and panic if the converted value doesn't fit
    |
236 |         Ok((block_no, byte_index.try_into().unwrap(), bit_index))
    |                                 ++++++++++++++++++++

error[E0308]: mismatched types
   --> src/lib.rs:236:35
    |
236 |         Ok((block_no, byte_index, bit_index))
    |                                   ^^^^^^^^^ expected `i32`, found `u32`
    |
help: you can convert a `u32` to an `i32` and panic if the converted value doesn't fit
    |
236 |         Ok((block_no, byte_index, bit_index.try_into().unwrap()))
    |                                            ++++++++++++++++++++

error[E0277]: `common::Error` doesn't implement `Debug`
   --> src/lib.rs:244:83
    |
244 |         let (block_no, byte_index, bit_index) = self.compute_indices(ino, offset).unwrap();
    |                                                                                   ^^^^^^ `common::Error` cannot be formatted using `{:?}`
    |
    = help: the trait `Debug` is not implemented for `common::Error`
    = note: add `#[derive(Debug)]` to `common::Error` or manually `impl Debug for common::Error`
note: required by a bound in `Result::<T, E>::unwrap`
   --> /rustc/90c541806f23a127002de5b4038be731ba1458ca/library/core/src/result.rs:1083:5
help: consider annotating `common::Error` with `#[derive(Debug)]`
   --> src/common.rs:66:1
    |
66  + #[derive(Debug)]
67  |             panic!("DiskFS must be the lowest layer, and state is null");
    |

error[E0308]: arguments to this method are incorrect
   --> src/lib.rs:247:20
    |
247 |         self.below.read(self.below_ino, block_no, buf);
    |                    ^^^^                 --------  --- expected `&mut Block`, found `Block`
    |                                         |
    |                                         expected `u32`, found `i32`
    |
note: method defined here
   --> src/common.rs:75:6
    |
75  |   fn read(&self, ino: u32, offset: u32, buf: &mut Block) -> 
    |      ^^^^
help: you can convert an `i32` to a `u32` and panic if the converted value doesn't fit
    |
247 |         self.below.read(self.below_ino, block_no.try_into().unwrap(), buf);
    |                                                 ++++++++++++++++++++
help: consider mutably borrowing here
    |
247 |         self.below.read(self.below_ino, block_no, &mut buf);
    |                                                   ~~~~~~~~

error[E0308]: mismatched types
   --> src/lib.rs:260:33
    |
260 |         if denom == 0 || num == 0 || num < denom {
    |                          ---    ^ expected `Result<u32, Error>`, found integer
    |                          |
    |                          expected because this is `Result<u32, common::Error>`
    |
    = note: expected enum `Result<u32, common::Error>`
               found type `{integer}`
help: try wrapping the expression in `core::prelude::v1::Ok`
    |
260 |         if denom == 0 || num == core::prelude::v1::Ok(0) || num < denom {
    |                                 ++++++++++++++++++++++ +

error[E0369]: binary operation `==` cannot be applied to type `Result<u32, common::Error>`
   --> src/lib.rs:260:30
    |
260 |         if denom == 0 || num == 0 || num < denom {
    |                          --- ^^ - Result<u32, common::Error>
    |                          |
    |                          Result<u32, common::Error>
    |
note: an implementation of `PartialEq` might be missing for `common::Error`
   --> src/common.rs:66:1
    |
66  | pub enum Error {
    | ^^^^^^^^^^^^^^ must implement `PartialEq`
help: consider annotating `common::Error` with `#[derive(PartialEq)]`
   --> src/common.rs:66:1
    |
66  + #[derive(PartialEq)]
67  |             panic!("DiskFS must be the lowest layer, and state is null");
    |

error[E0308]: mismatched types
   --> src/lib.rs:260:44
    |
260 |         if denom == 0 || num == 0 || num < denom {
    |                                      ---   ^^^^^ expected `Result<u32, Error>`, found `u32`
    |                                      |
    |                                      expected because this is `Result<u32, common::Error>`
    |
    = note: expected enum `Result<u32, common::Error>`
               found type `u32`
help: try wrapping the expression in `core::prelude::v1::Ok`
    |
260 |         if denom == 0 || num == 0 || num < core::prelude::v1::Ok(denom) {
    |                                            ++++++++++++++++++++++     +

error[E0369]: binary operation `<` cannot be applied to type `Result<u32, common::Error>`
   --> src/lib.rs:260:42
    |
260 |         if denom == 0 || num == 0 || num < denom {
    |                                      --- ^ ----- Result<u32, common::Error>
    |                                      |
    |                                      Result<u32, common::Error>
    |
note: an implementation of `PartialOrd` might be missing for `common::Error`
   --> src/common.rs:66:1
    |
66  | pub enum Error {
    | ^^^^^^^^^^^^^^ must implement `PartialOrd`
help: consider annotating `common::Error` with `#[derive(PartialEq, PartialOrd)]`
   --> src/common.rs:66:1
    |
66  + #[derive(PartialEq, PartialOrd)]
67  |             panic!("DiskFS must be the lowest layer, and state is null");
    |

error[E0369]: cannot divide `Result<u32, common::Error>` by `u32`
   --> src/lib.rs:264:16
    |
264 |         Ok(num / denom)
    |            --- ^ ----- u32
    |            |
    |            Result<u32, common::Error>

error[E0599]: the method `get_metadata` exists for reference `&SimpleFS<'_, T>`, but its trait bounds were not satisfied
   --> src/lib.rs:273:36
    |
273 |         let metadata_offset = self.get_metadata()?.num_blocks_needed;
    |                                    ^^^^^^^^^^^^ method cannot be called on `&SimpleFS<'_, T>` due to unsatisfied trait bounds
    |
note: trait bound `T: common::IsDisk` was not satisfied
   --> src/lib.rs:136:21
    |
136 | impl<T: Stackable + IsDisk> SimpleFS<'_, T> {
    |                     ^^^^^^  ---------------
    |                     |
    |                     unsatisfied trait bound introduced here

error[E0308]: mismatched types
   --> src/lib.rs:279:12
    |
279 |         Ok(self.below.read(self.below_ino, full_offset, buf))
    |         -- ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ expected `i32`, found `Result<i32, Error>`
    |         |
    |         arguments to this enum variant are incorrect
    |
    = note: expected type `i32`
               found enum `Result<i32, common::Error>`
help: the type constructed contains `Result<i32, common::Error>` due to the type of the argument passed
   --> src/lib.rs:279:9
    |
279 |         Ok(self.below.read(self.below_ino, full_offset, buf))
    |         ^^^-------------------------------------------------^
    |            |
    |            this argument influences the type of `Ok`
note: tuple variant defined here
   --> /rustc/90c541806f23a127002de5b4038be731ba1458ca/library/core/src/result.rs:507:5

error[E0599]: the method `get_metadata` exists for mutable reference `&mut SimpleFS<'_, T>`, but its trait bounds were not satisfied
   --> src/lib.rs:283:36
    |
283 |         let metadata_offset = self.get_metadata()?.num_blocks_needed;
    |                                    ^^^^^^^^^^^^ method cannot be called on `&mut SimpleFS<'_, T>` due to unsatisfied trait bounds
    |
note: trait bound `T: common::IsDisk` was not satisfied
   --> src/lib.rs:136:21
    |
136 | impl<T: Stackable + IsDisk> SimpleFS<'_, T> {
    |                     ^^^^^^  ---------------
    |                     |
    |                     unsatisfied trait bound introduced here

error[E0308]: mismatched types
   --> src/lib.rs:290:18
    |
290 |         if res < 0 {
    |            ---   ^ expected `Result<i32, Error>`, found integer
    |            |
    |            expected because this is `Result<i32, common::Error>`
    |
    = note: expected enum `Result<i32, common::Error>`
               found type `{integer}`
help: try wrapping the expression in `core::prelude::v1::Ok`
    |
290 |         if res < core::prelude::v1::Ok(0) {
    |                  ++++++++++++++++++++++ +

error[E0369]: binary operation `<` cannot be applied to type `Result<i32, common::Error>`
   --> src/lib.rs:290:16
    |
290 |         if res < 0 {
    |            --- ^ - Result<i32, common::Error>
    |            |
    |            Result<i32, common::Error>
    |
note: an implementation of `PartialOrd` might be missing for `common::Error`
   --> src/common.rs:66:1
    |
66  | pub enum Error {
    | ^^^^^^^^^^^^^^ must implement `PartialOrd`
help: consider annotating `common::Error` with `#[derive(PartialEq, PartialOrd)]`
   --> src/common.rs:66:1
    |
66  + #[derive(PartialEq, PartialOrd)]
67  |             panic!("DiskFS must be the lowest layer, and state is null");
    |

error[E0599]: the method `compute_indices` exists for mutable reference `&mut SimpleFS<'_, T>`, but its trait bounds were not satisfied
   --> src/lib.rs:295:54
    |
295 |         let (block_no, byte_index, bit_index) = self.compute_indices(ino, offset).unwrap();
    |                                                      ^^^^^^^^^^^^^^^ method cannot be called on `&mut SimpleFS<'_, T>` due to unsatisfied trait bounds
    |
note: trait bound `T: common::IsDisk` was not satisfied
   --> src/lib.rs:136:21
    |
136 | impl<T: Stackable + IsDisk> SimpleFS<'_, T> {
    |                     ^^^^^^  ---------------
    |                     |
    |                     unsatisfied trait bound introduced here

error[E0308]: mismatched types
   --> src/lib.rs:297:51
    |
297 |         self.below.read(self.below_ino, block_no, buf);
    |                    ----                           ^^^
    |                    |                              |
    |                    |                              expected `&mut Block`, found `Block`
    |                    |                              help: consider mutably borrowing here: `&mut buf`
    |                    arguments to this method are incorrect
    |
note: method defined here
   --> src/common.rs:75:6
    |
75  |   fn read(&self, ino: u32, offset: u32, buf: &mut Block) -> 
    |      ^^^^

error[E0308]: mismatched types
   --> src/lib.rs:302:52
    |
302 |         self.below.write(self.below_ino, block_no, buf);
    |                    -----                           ^^^
    |                    |                               |
    |                    |                               expected `&Block`, found `Block`
    |                    |                               help: consider borrowing here: `&buf`
    |                    arguments to this method are incorrect
    |
note: method defined here
   --> src/common.rs:77:6
    |
77  |   fn write(&mut self, ino: u32, offset: u32, buf: &Block) -> 
    |      ^^^^^

error[E0600]: cannot apply unary operator `-` to type `u32`
   --> src/lib.rs:335:54
    |
335 |     SimpleFS::from(inode_store).get_size().unwrap_or(-1)
    |                                                      ^^
    |                                                      |
    |                                                      cannot apply unary operator `-`
    |                                                      help: you may have meant the maximum value of `u32`: `u32::MAX`
    |
    = note: unsigned values cannot be negated

error[E0282]: type annotations needed
   --> src/lib.rs:346:5
    |
346 |     SimpleFS::from(inode_store).set_size(size as u32).unwrap_or(-1)
    |     ^^^^^^^^^^^^^^ cannot infer type of the type parameter `T` declared on the struct `SimpleFS`
    |
help: consider specifying the generic argument
    |
346 |     SimpleFS::<T>(inode_store).set_size(size as u32).unwrap_or(-1)
    |             ~~~~~

error[E0308]: mismatched types
   --> src/lib.rs:356:68
    |
356 |     SimpleFS::from(inode_store).read(ino, offset, &mut Block::from(block)).unwrap_or(-1)
    |                                                        ----------- ^^^^^ expected `common::block`, found `block`
    |                                                        |
    |                                                        arguments to this function are incorrect
    |
    = note: `block` and `common::block` have similar names, but are actually distinct types
note: `block` is defined in module `crate` of the current crate
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:30:1
    |
30  | pub struct block {
    | ^^^^^^^^^^^^^^^^
note: `common::block` is defined in module `crate::common` of the current crate
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:30:1
    |
30  | pub struct block {
    | ^^^^^^^^^^^^^^^^
note: associated function defined here
   --> src/common.rs:49:10
    |
49  |   pub fn from(block: *mut block_t) -> Self {
    |          ^^^^ -------------------

error[E0308]: mismatched types
   --> src/lib.rs:366:69
    |
366 |     SimpleFS::from(inode_store).write(ino, offset, &mut Block::from(block)).unwrap_or(-1)
    |                                                         ----------- ^^^^^ expected `common::block`, found `block`
    |                                                         |
    |                                                         arguments to this function are incorrect
    |
    = note: `block` and `common::block` have similar names, but are actually distinct types
note: `block` is defined in module `crate` of the current crate
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:30:1
    |
30  | pub struct block {
    | ^^^^^^^^^^^^^^^^
note: `common::block` is defined in module `crate::common` of the current crate
   --> /vagrant/rusty_c/mydisk/target/riscv64gc-unknown-none-elf/debug/build/mydisk-7b565f6546538fc7/out/bindings.rs:30:1
    |
30  | pub struct block {
    | ^^^^^^^^^^^^^^^^
note: associated function defined here
   --> src/common.rs:49:10
    |
49  |   pub fn from(block: *mut block_t) -> Self {
    |          ^^^^ -------------------

warning: unused import: `core::convert::From`
 --> src/lib.rs:8:5
  |
8 | use core::convert::From;   
  |     ^^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` on by default

Some errors have detailed explanations: E0277, E0282, E0308, E0369, E0425, E0433, E0434, E0435, E0599...
For more information about an error, try `rustc --explain E0277`.
warning: `mydisk` (lib) generated 8 warnings
The following warnings were emitted during compilation:

warning: /vagrant/rusty_c/mydisk/file/disk.h:1:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/egos.h:1:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/file.h:33:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/inode.h:38:9: warning: #pragma once in main file
warning:  #pragma once
warning:          ^~~~
warning: /vagrant/rusty_c/mydisk/file/disk.c: In function 'disk_setsize':
warning: /vagrant/rusty_c/mydisk/file/disk.c:16:1: warning: no return statement in function returning non-void [-Wreturn-type]
warning:  static int disk_setsize() { FATAL("disk: cannot set the size"); }
warning:  ^~~~~~
warning: /vagrant/rusty_c/mydisk/file/disk.c: In function 'disk_read':
warning: /vagrant/rusty_c/mydisk/file/disk.c:18:33: warning: unused parameter 'bs' [-Wunused-parameter]
warning:  static int disk_read(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                       ~~~~~~~~~~~^~
warning: /vagrant/rusty_c/mydisk/file/disk.c:18:50: warning: unused parameter 'ino' [-Wunused-parameter]
warning:  static int disk_read(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                                      ~~~~~~~~~~~~~^~~
warning: /vagrant/rusty_c/mydisk/file/disk.c: In function 'disk_write':
warning: /vagrant/rusty_c/mydisk/file/disk.c:22:34: warning: unused parameter 'bs' [-Wunused-parameter]
warning:  static int disk_write(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                        ~~~~~~~~~~~^~
warning: /vagrant/rusty_c/mydisk/file/disk.c:22:51: warning: unused parameter 'ino' [-Wunused-parameter]
warning:  static int disk_write(inode_intf bs, unsigned int ino, block_no offset, block_t *block) {
warning:                                       ~~~~~~~~~~~~~^~~

error: could not compile `mydisk` (lib) due to 51 previous errors; 8 warnings emitted
